TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `treturbeli` BEFORE UPDATE ON `retur_beli` FOR EACH ROW BEGIN\n/*asli\ndelete from keuangan where no_transaksi=new.no_retur;\ninsert into keuangan(tanggal,keterangan,pemasukan,jenis,no_transaksi) values (new.tanggal,\'Retur beli\',new.total,\'Retur beli\',new.no_retur);\n*/\ndelete from jurnal where no_transaksi=new.no_retur;\ninsert into jurnal values(\'\',new.Tanggal,\'2.1\',\'Utang dagang\',new.total,0,new.no_retur,\'\');\ninsert into jurnal values(\'\',new.Tanggal,\'1.5\',\'   Persediaan barang dagang\',0,new.total,new.no_retur,\'\');\n\n\n\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `treturbeli2` BEFORE DELETE ON `retur_beli` FOR EACH ROW BEGIN\n/*asli\ndelete from keuangan where no_transaksi=old.no_retur;\ndelete from detilreturbeli where no_retur=old.no_retur;\n*/\ndeclare vid varchar(20);\ndelete from keuangan where no_transaksi=old.no_retur;\ndelete from jurnal where no_transaksi=old.no_retur;\ndelete from detilreturbeli where no_retur=old.no_retur;\nset vid=(select id_supplier from pembelian where no_pembelian=old.no_pembelian);\nset @vid=vid;\nupdate hutang set jumlah_hutang=jumlah_hutang+old.total where no_pembelian=old.no_pembelian;\nupdate tblsupplier set jumlah_hutang=jumlah_hutang+old.total where id_supplier=@vid;\ndelete from detilreturbeli where no_retur=old.no_retur;\nEND'
sql_modes=1342177280 1342177280
definers='root@localhost' 'root@localhost'
