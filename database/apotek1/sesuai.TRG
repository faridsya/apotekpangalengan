TYPE=TRIGGERS
triggers='CREATE DEFINER=`root`@`localhost` TRIGGER `tsesuaiad` AFTER DELETE ON `sesuai` FOR EACH ROW BEGIN\nif old.Jenis=\'Menambah\' then\nupdate stokgudang set jumlah=jumlah-old.jumlah where kode_brg=old.kode_brg and kode_gudang=old.kode_gudang;\nelse\nupdate stokgudang set jumlah=jumlah+old.jumlah where kode_brg=old.kode_brg and kode_gudang=old.kode_gudang;\nend if;\ndelete from jurnal where no_transaksi=old.id and keterangan2=\'stok\';\nEND' 'CREATE DEFINER=`root`@`localhost` TRIGGER `tsesuaiai` AFTER INSERT ON `sesuai` FOR EACH ROW BEGIN\ndeclare vhpp double(19,2);declare vmdl double(19,2);\nSET vmdl=(select harga_beli from tblbarang where kode_brg=new.kode_brg);\nset vhpp=vmdl*new.jumlah;\nif new.Jenis=\'Menambah\' then\nupdate stokgudang set jumlah=jumlah+new.jumlah where kode_brg=new.kode_brg and kode_gudang=new.kode_gudang;\n	if new.akun=\'Koreksi stok\' then\n	insert into jurnal values(\'\',new.Tanggal,\'1.5\',\'Persediaan barang dagang\',vhpp,0,new.id,\'stok\');\n	insert into jurnal values(\'\',new.Tanggal,\'5.78\',\'   Koreksi stok\',0,vhpp,new.id,\'stok\');\n	\n	else\n	insert into jurnal values(\'\',new.Tanggal,\'1.5\',\'Persediaan barang dagang\',vhpp,0,new.id,\'stok\');\n	insert into jurnal values(\'\',new.Tanggal,\'8.7\',\'   Pendapatan stok bertambah\',0,vhpp,new.id,\'stok\');\n	end if;\nelse\nupdate stokgudang set jumlah=jumlah-new.jumlah where kode_brg=new.kode_brg and kode_gudang=new.kode_gudang;\nif new.akun=\'Koreksi stok\' then\n	insert into jurnal values(\'\',new.Tanggal,\'5.78\',\'Koreksi stok\',vhpp,0,new.id,\'stok\');\n	insert into jurnal values(\'\',new.Tanggal,\'1.5\',\'   Persediaan barang dagang\',0,vhpp,new.id,\'stok\');\n\n	\n	else\n	insert into jurnal values(\'\',new.Tanggal,\'5.5\',\'Beban stok berkurang\',vhpp,0,new.id,\'stok\');\n	insert into jurnal values(\'\',new.Tanggal,\'1.5\',\'   Persediaan barang dagang\',0,vhpp,new.id,\'stok\');\n	\n	end if;\nend if;\nEND'
sql_modes=1342177280 1342177280
definers='root@localhost' 'root@localhost'
